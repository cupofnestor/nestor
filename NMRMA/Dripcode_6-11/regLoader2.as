 package{	import flash.net.*;	import flash.display.*;	import flash.events.*;	import caurina.transitions.*; 	public class regLoader2 extends graph	{		//var server:String = "http://map-server.local";		var server:String = "http://localhost:8080";	   // var server:String = "http://10.111.2.102:8080";		//var server:String = "http://192.168.1.124:8080";		//var server:String="http://10.111.2.102:8080";		var phpFile:String = server+"/dripcode/reg2.php";		var request:URLRequest = new URLRequest(phpFile);		var phpVars:URLVariables = new URLVariables();		var map:MovieClip = new MovieClip();		var regCode:String;		var hucCode:String;		public var reg_name:String;		var dLoaded:dispatcher = new dispatcher("regLoader");				public function regLoader2(_regCode:String):void		{			regCode = _regCode;			trace("REquesting "+regCode);			request.method = URLRequestMethod.POST;			callServer();		}			public function regNameF():String		{			return reg_name;		}		private function callServer():void		{			trace("calling");			phpVars.reg = regCode;			request.data = phpVars;			trace("phpVars:"+phpVars);			var loader:URLLoader = new URLLoader();			loader.dataFormat = URLLoaderDataFormat.VARIABLES;			loader.addEventListener(Event.COMPLETE, serverResponse);			loader.load(request);		}		private function serverResponse(e:Event):void		{			trace('serverREsponse');			var mapLoaded:Function = function mapLoaded(e:Event):void						{				var map_img:Bitmap = e.target.content as Bitmap;				map.addChild(map_img);				addChild(map);				//map.alpha=0;				//Tweener.addTween( map, {alpha:1, time:2, transition:"easeOutExpo",onComplete:loaded_handler});				dLoaded.loaded();				reg_name = stripSpaces(reg_name);				//huc_name = huc_name.split(".").join("");				//watershedName.text="You live in the "+huc_name+" Watershed!";							}			var mapProgress:Function = function mapProgress(e:ProgressEvent):void			{				trace(e.bytesLoaded+" of "+e.bytesTotal+" bytes loaded.");			}			trace(e.target.data);			reg_name = e.target.data.reg_name;						var imgURL:String = e.target.data.imgURL;			trace("imgURL="+imgURL+"reg name is "+reg_name);			var mapLoader:Loader = new Loader();			mapLoader.contentLoaderInfo.addEventListener(Event.COMPLETE,mapLoaded);			mapLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS,mapProgress);			var mapRequest:URLRequest = new URLRequest(server+imgURL);			mapLoader.load(mapRequest);		}		function stripSpaces (input:String):String		{			var newString:String = "";			for (var j:Number=0; j<input.length; j++) 			{				if (input.charAt(j)!=".") 				{					newString += input.charAt(j);				}				else break;			}		return newString;		}					}			}